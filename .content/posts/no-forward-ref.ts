export default {
  "filePath": "/Users/ben/Documents/workspace/project/z1/posts/no-forward-ref.md",
  "content": "<h3>关于 forwardRef 和 ts 泛型问题</h3>\n<p>参考\n<a href=\"https://fettblog.eu/typescript-react-generic-forward-refs/\">forwardRef 泛型</a></p>\n<p>实践代码</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// Redeclare forwardRef</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">declare</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> module</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'react'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  function</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> forwardRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> P</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {}>(</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    render</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (props</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> P</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> ref</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Ref</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">ReactNode</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> |</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> null</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  )</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (props</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> P</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> &#x26;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">RefAttributes</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">ReactNode</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> |</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> null</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// Just write your components like you're used to!</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">type</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ClickableListProps</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  items</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">[];</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  onSelect</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (item</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> void</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">};</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">function</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ClickableListInner</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>(</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  props</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ClickableListProps</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  ref</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">ForwardedRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">HTMLUListElement</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    &#x3C;</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">ul</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ref</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">{ref}></span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      {</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">props</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">items</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.map</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((item</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> i) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        &#x3C;</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">li</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">{i}></span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">          &#x3C;</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">button</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> onClick</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">{(el) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> props</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.onSelect</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(item)}>Select&#x3C;/</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">button</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">          {item}</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        &#x3C;/</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">li</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      ))}</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    &#x3C;/</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">ul</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  );</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> ClickableList</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> React</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.forwardRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(ClickableListInner);</span></span></code></pre>\n<h3>通过 props 传递多个 ref</h3>\n<p>ref 是 react 的保留字，所以通过 props 传递 ref 时，需要重新命名，比如:</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">function</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Text</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({textRef:Ref&#x3C;object>}) {</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  useImxxx</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(textRef</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> ()</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">{</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {}</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  })</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">...</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> textRef</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">()</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">Text</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> textRef</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">{textRef}></span></span>\n<span class=\"line\"></span></code></pre>",
  "fileName": "no-forward-ref",
  "subject": [],
  "md5": "7ce0bfc64ce6340f5949888c0107ae66",
  "id": "5oHNC2",
  "frontMatter": {
    "title": "不需要使用 forwardRef",
    "description": "将 ref 作为 props 传递是更优的方案。",
    "cover": "https://images.unsplash.com/photo-1448387473223-5c37445527e7?q=80&w=1800&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
  },
  "updateAt": 1758938061199
}