type FrontMatter = {
  title: string;
  description?: string;
  cover?:string;
};

export type PostType = {
  filePath: string;
  content: string;
  fileName: string;
  subject: string[];
  md5: string;
  frontMatter: FrontMatter;
};

 export const allPosts : PostType[] = [
  {
    "filePath": "/Users/ben/Documents/workspace/project/z1-blog/posts/generated-api.md",
    "content": "<h2>构建类型安全的 API 函数</h2>\n<h3>安装依赖</h3>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">bun</span><span style=\"color:#2B5581;--shiki-dark:#9DB1C5\"> add</span><span style=\"color:#2B5581;--shiki-dark:#9DB1C5\"> orval</span><span style=\"color:#2B5581;--shiki-dark:#9DB1C5\"> -D</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">bun</span><span style=\"color:#2B5581;--shiki-dark:#9DB1C5\"> add</span><span style=\"color:#2B5581;--shiki-dark:#9DB1C5\"> di-fetch</span><span style=\"color:#2B5581;--shiki-dark:#9DB1C5\"> swr</span></span></code></pre>\n<h3>配置 orval</h3>\n<p>新建 .orval.config.js</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { defineConfig } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'orval'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> default</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> defineConfig</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  v1</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    output</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      mode</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'tags'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      target</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> './src/api/generated/spec'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // 配置路径</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      schemas</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> './src/api/generated/model'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // 配置路径</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      client</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'swr'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      override</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        mutator</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">          path</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> './src/api/fetch-transit.ts'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // 配置路径</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">          name</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'fetchTransit'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      clean</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> true</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    input</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      target</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'xxx'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    hooks</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      afterAllFilesWrite</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'prettier --write'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">});</span></span></code></pre>\n<p>新建 fetch-transit.ts 文件</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// custom-instance.ts</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { HTTPErrors</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> fetchX </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">as</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> diFetch } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'di-fetch'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { Method } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'di-fetch/build/type'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> const</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> fetchTransit</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> async</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> &#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Res</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>(options</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  url</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  method</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Method</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  params</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> unknown</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  data</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> unknown</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  headers</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> unknown</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">})</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Promise</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Res</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { url: </span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">path</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> params</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> data</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> method</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> ...</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">restOptions</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> options;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> response</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> await</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> diFetch</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    path</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    data</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> data </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">||</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> params</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    method</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    ...</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">restOptions</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  });</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> response </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">as</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Res</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> default</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> fetchTransit;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// // In some case with react-query and swr you want to be able to override the return error type so you can also do it here like this</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// @ts-ignore</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// eslint-disable-next-line @typescript-eslint/no-unused-vars</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> type</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ErrorType</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Error</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> HTTPErrors</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// // In case you want to wrap the body type (optional)</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// // (if the custom instance is processing data before sending it, like changing the case for example)</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> type</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> BodyType</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">BodyData</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> BodyData</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span></code></pre>\n<p>新增 fetch-engine.ts</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { Config } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> '@/src/constants/envs'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { fetch } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'expo/fetch'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> getCustomUserAgent </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> '@/src/libs/getCustomUserAgent'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { getCircularReplacer } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> '@/src/utils/json'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { Client</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> FetchEngine } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'di-fetch'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { ProcessedRequestOptions</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> RequestData } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'di-fetch/build/type'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">const</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> client</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Client</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> async</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> &#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Request</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> RequestData</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Response</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>(</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  req</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ProcessedRequestOptions</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Request</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { </span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">url</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> method</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> data</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> ...</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">restOptions</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> req;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> options</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Record</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">string</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> any</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    method</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    ...</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">restOptions</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">  // Ensure headers are properly cloned to avoid \"Already in the pool!\" error</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">options</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.headers) {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">    options</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.headers </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">...</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">options</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.headers };</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  let</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> fullUrl </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> url;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> ([</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'POST'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'PUT'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">]</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.includes</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(method)) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (data </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">&#x26;&#x26;</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> !</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(data </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">instanceof</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> FormData</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)) {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">      options</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.body </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> JSON</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.stringify</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(data</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> getCircularReplacer</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">());</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">else</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">      options</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.body </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> data;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (method </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">===</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'GET'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    let</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> queryString </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> ''</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (data) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> searchParams</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> new</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> URLSearchParams</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(data </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">as</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Record</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">string</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      queryString </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> `?</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">searchParams</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.toString</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">()</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">`</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    fullUrl </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> `</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">url</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}${</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">queryString</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">`</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  let</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> response;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  try</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    response </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> await</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> fetch</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(fullUrl</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> options);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">catch</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (error) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    throw</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> error;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">  // const _response = response.clone();</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">!</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">response</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.ok) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    let</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> data </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {};</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    try</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      data </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> await</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> response</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.json</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">();</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">catch</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (error) {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">      console</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.error</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'[parse response error]'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> error</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> response);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">response</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">headers</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.get</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'Content-Type'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">?.includes</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'application/json'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> json</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> await</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> response</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.json</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">();</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> json;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">response</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">headers</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.get</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'Content-Type'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">?.includes</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'text/plain'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> text</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> await</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> response</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.text</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">();</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> text;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> response;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> fetchEngine</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> new</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> FetchEngine</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  baseUrl</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> Config</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.apiUrl</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">!</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  client</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">});</span></span></code></pre>\n<p>在 App 初始化文件引入 fetch-engine, 然后在用户登录后，注入 token 。</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">fetchEngine</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.setHeaders</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  authorization</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> `Bearer </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">user</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.token</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">`</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">});</span></span></code></pre>",
    "fileName": "generated-api",
    "subject": [],
    "md5": "07c6d395ac9560c949ee6968cbe301e6",
    "frontMatter": {
      "title": "构建类型安全的 API 函数",
      "description": "通过 swagger api document 生成 API 函数",
      "cover": "https://images.pexels.com/photos/11035364/pexels-photo-11035364.jpeg"
    }
  },
  {
    "filePath": "/Users/ben/Documents/workspace/project/z1-blog/posts/rn-practice.md",
    "content": "<h2>RN 开发常见需求</h2>\n<p>RN 应用开发常见需求整理如下：</p>\n<ul>\n<li>自适应屏幕尺寸，根据屏幕尺寸自动缩放 UI 元素大小。解决方案：使用 nativeWind 里 <code>100vw</code> 等于 <code>screen.width</code> 的特性，使用 <code>pxToVw plugin</code>。</li>\n<li>i18n 国际化需求。解决方案：使用 <code>LingUI</code> 库，可以更方便在代码里实现多语言文本。</li>\n<li>网络请求与路由。解决方案：使用 <code>expo-router</code> 定义路由。使用 openAPI 自动生成 <code>swr hook</code> 代码。</li>\n<li>动画与 UX。解决方案：<code>react-native-reanimated</code>，正在积累更多实践。</li>\n<li>打包与构建。解决方案：<code>expo run:android --device</code> , <code>expo run:ios --device</code></li>\n<li>高性能列表与 Tabs 切换列表。未解决。</li>\n<li>虚拟键盘遮挡输入区问题。未解决。</li>\n<li>图片请求/显示，、缓存。解决方案：<code>expo-image</code> ，正在积累更多实践。</li>\n<li>webview ，显示尺寸。解决方案：``。</li>\n<li>Modal 与 Toast。未解决。</li>\n<li>测试用例。未解决。</li>\n<li>Android 应用隐私政策弹窗。解决方案：Android 原生端。</li>\n</ul>",
    "fileName": "rn-practice",
    "subject": [],
    "md5": "a31677fb7e5ca861050a7c4f046bfa3e",
    "frontMatter": {
      "title": "React Native 应用开发解决方案",
      "description": "掌握 RN 开发各种需求解决方案",
      "cover": "https://pica.zhimg.com/70/v2-2fa9b2dac5b217a1a22a5cb3b47c6a4f_1440w.avis?source=172ae18b&biz_tag=Post"
    }
  },
  {
    "filePath": "/Users/ben/Documents/workspace/project/z1-blog/posts/flex-responsive.md",
    "content": "<h2>Flex 的自适应</h2>\n<p><code>flex:1</code> 可以实现继承父元素剩余高度。</p>\n<h3>flex 防溢出</h3>\n<p>当设置元素的宽度等于父容器剩余内容的宽度时，要给元素添加 <code>overflow:hidden</code>，避免元素被子元素撑开。</p>\n<h3>flex:1 剩余空间多重继承</h3>\n<p>设置元素的高度等于父容器剩余内容的高度时，同时父容器也是通过 <code>flex-grow:1</code> 获得其父容器高度时，则该父容器必须添加 <code>height:0</code> (值不影响)</p>",
    "fileName": "flex-responsive",
    "subject": [],
    "md5": "c41a9db8d89b132f5e94b232f6c17279",
    "frontMatter": {
      "title": "CSS 灵活的自适应宽高",
      "description": "子元素如何自适应自身宽高或继承父元素 flex:1 的元素等",
      "cover": "https://images.unsplash.com/photo-1607799279861-4dd421887fb3?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
    }
  },
  {
    "filePath": "/Users/ben/Documents/workspace/project/z1-blog/posts/rn-portal.md",
    "content": "<h2>React Native 的 Portal 组件</h2>\n<p>代码组件文件</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">├──</span><span style=\"color:#2B5581;--shiki-dark:#9DB1C5\"> Portal.tsx</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">├──</span><span style=\"color:#2B5581;--shiki-dark:#9DB1C5\"> PortalContext.tsx</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">└──</span><span style=\"color:#2B5581;--shiki-dark:#9DB1C5\"> PortalHost.tsx</span></span></code></pre>\n<h3>PortalHost.tsx</h3>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// portal/PortalHost.tsx</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> React</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { useState</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> useCallback } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'react'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { View</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> StyleSheet } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'react-native'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { PortalContext } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> './PortalContext'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> function</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> PortalHost</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({ children }</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { children</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">ReactNode</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> }) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> nextKey</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\">0</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">portals</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> setPortals</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">] </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> useState</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">&#x3C;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    { key</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> number; children</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.ReactNode }[]</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  ></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">([]);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> mount</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useCallback</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> children</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">ReactNode</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    setPortals</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((prev) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">...</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">prev</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { key</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> children }]);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> []);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> update</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useCallback</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> children</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">ReactNode</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    setPortals</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((prev) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">      prev</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.map</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((item) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">item</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.key </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">===</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> key </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">...</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">item</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> children } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> item))</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    );</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> []);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> unmount</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useCallback</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    setPortals</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((prev) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> prev</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.filter</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((item) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> item</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.key </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">!==</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> key));</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> []);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> contextValue</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({ mount</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> update</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> unmount }).current;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    &#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">PortalContext.Provider</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> value</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">{contextValue}></span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      {children}</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      {</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">portals</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.map</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(({ key</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> children }) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        &#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">View</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">          key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">{key}</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">          style</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">{</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">StyleSheet</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.absoluteFill}</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">          // pointerEvents=\"box-none\"</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        ></span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">          {children}</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        &#x3C;/</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">View</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      ))}</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    &#x3C;/</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">PortalContext.Provider</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  );</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span></code></pre>\n<h3>Portal.tsx</h3>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// portal/Portal.tsx</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> React</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { useContext</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> useEffect</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> useRef } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'react'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { PortalContext } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> './PortalContext'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">let</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> globalKey </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 0</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> function</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Portal</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({ children }</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { children</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">ReactNode</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> }) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> manager</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useContext</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(PortalContext);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">!</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">manager) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    throw</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> new</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Error</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'Portal must be rendered inside a PortalHost'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> keyRef</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>(globalKey</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">++</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> keyRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  useEffect</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">    manager</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.mount</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(key</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> children);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> () </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> manager</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.unmount</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(key);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [children</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> key</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> manager]);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  useEffect</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">    manager</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.update</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(key</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> children);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [children</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> key</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> manager]);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  return</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> null</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span></code></pre>\n<h3>PortalContext.tsx</h3>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// portal/PortalContext.tsx</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> React </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'react'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> PortalContext</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> React</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.createContext</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  mount</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> children</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">ReactNode</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> void</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  update</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> children</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> React</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">ReactNode</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> void</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  unmount</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> void</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">} </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">|</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> null</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>(</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">null</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span></code></pre>",
    "fileName": "rn-portal",
    "subject": [],
    "md5": "a488a55d6a6f22d44f2e219dd17c1de1",
    "frontMatter": {
      "title": "RN 的 Portal 组件",
      "description": null,
      "cover": "https://images.pexels.com/photos/32862970/pexels-photo-32862970.jpeg"
    }
  },
  {
    "filePath": "/Users/ben/Documents/workspace/project/z1-blog/posts/string-tpl.md",
    "content": "<h2>类型安全的字符串替换函数</h2>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">type</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ExtractKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  T</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> `</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">infer</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> _Start</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">{</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">infer</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Param</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">}</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">infer</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Rest</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">`</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    ?</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Param</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> `</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">infer</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Name</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">?`</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      ?</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Name</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> |</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ExtractKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Rest</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      :</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Param</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> |</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ExtractKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Rest</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    :</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> never</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">type</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> OptionalKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  T</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> `</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">infer</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> _Start</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">{</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">infer</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Param</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">}</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">infer</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Rest</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">`</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    ?</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Param</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> `</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">infer</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Name</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">?`</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      ?</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Name</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> |</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> OptionalKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Rest</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      :</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> OptionalKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">Rest</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    :</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> never</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">type</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ParamsFromTemplate</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  ExtractKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">extends</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> never</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    ?</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> undefined</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    :</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        [</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">K</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> in</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ExtractKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">as</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> K</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> OptionalKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> K</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> :</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> never</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">]</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?:</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">          |</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">          |</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">&#x26;</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        [</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">K</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> in</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ExtractKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">as</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> K</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> OptionalKeys</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">> </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> never</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> :</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> K</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">]</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">          |</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">          |</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">function</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> stringTpl</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>(</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  template</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> T</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  params</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> ParamsFromTemplate</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">></span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  return</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> template</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.replace</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">/{([</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">^</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">}]</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">+</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">)}/</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">g</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (_</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> rawKey</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> string</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> isOptional</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> rawKey</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.endsWith</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'?'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> isOptional </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> rawKey</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.slice</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\">0</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> -</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\">1</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> rawKey;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> val</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (params </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">as</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> any</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)?.[key];</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (val </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">==</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> null</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (isOptional) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">return</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> ''</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      throw</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> new</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Error</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">`Missing value for key: </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">`</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    return</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> String</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(val);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  });</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// console.log(stringTpl('/{id}/', { id: 12 }));</span></span></code></pre>",
    "fileName": "string-tpl",
    "subject": [],
    "md5": "5f261f9576937fcb3b5f1e15798e5936",
    "frontMatter": {
      "title": "类型安全的字符串替换函数",
      "description": "使用类型安全的字符串模板替换函数 - stringTpl",
      "cover": "https://images.unsplash.com/photo-1752867494754-f2f0accbc7d9?q=80&w=2670&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
    }
  },
  {
    "filePath": "/Users/ben/Documents/workspace/project/z1-blog/posts/rn-px-to-vw.md",
    "content": "<h2>在 RN 中使用 pxToVw 函数</h2>\n<p>pxToVw 函数：</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// plugins/px-to-vw.js</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> default</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> function</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> pxToVwPlugin</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({ matchUtilities }) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> designWidth</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 414</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">; </span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// NOTE: 根据设计稿尺寸配置</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> toVW</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (value) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> px</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> parseFloat</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(value);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> vw</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> ((px </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">/</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> designWidth) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">*</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 100</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.toFixed</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\">3</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    return</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> `</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">${</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">vw</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">}</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">vw`</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">  // width</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  matchUtilities</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">      w</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (value) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">        if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">!</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">value</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.endsWith</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'px'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {};</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">        return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { width</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> toVW</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(value) };</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      values</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { </span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'*'</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> ''</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      type</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'length'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // ✅ 防止歧义：明确为 length 类型</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  );</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">  // height</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  matchUtilities</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">      h</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (value) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">        if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">!</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">value</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.endsWith</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'px'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {};</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">        return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { height</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> toVW</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(value) };</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      values</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { </span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'*'</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> ''</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      type</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'length'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  );</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">  // fontSize</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  matchUtilities</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">      text</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (value) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">        if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">!</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">value</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.endsWith</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'px'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {};</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">        return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { fontSize</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> toVW</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(value) };</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      values</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { </span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'*'</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> ''</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      type</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'length'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  );</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">  // borderRadius</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  matchUtilities</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">      rounded</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (value) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">        if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">!</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">value</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.endsWith</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'px'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">)) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {};</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">        return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { borderRadius</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> toVW</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(value) };</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      values</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { </span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'*'</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> ''</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      type</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'length'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  );</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span></code></pre>\n<p>在 tailwind.config.js 中配置插件</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> pxToVwPlugin </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> \"./pxToVw\"</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">...</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">/** </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">@type</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> {import('tailwindcss').Config}</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> */</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">module</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">exports</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  plugins</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">...</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> pxToVwPlugin]</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span></code></pre>",
    "fileName": "rn-px-to-vw",
    "subject": [],
    "md5": "0198e9d50b6cbf3a8f932b129f5f7af7",
    "frontMatter": {
      "title": "在 RN 中使用 pxToVw 函数",
      "description": "通过 nativewind 对 vw 的支持，提供自适应页面转换",
      "cover": "https://images.pexels.com/photos/2649403/pexels-photo-2649403.jpeg"
    }
  },
  {
    "filePath": "/Users/ben/Documents/workspace/project/z1-blog/posts/snippets/anime-async.md",
    "content": "<h3>优化异步等待动画的 Hook</h3>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { useCallback</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> useEffect</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> useState } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'react'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">enum</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> State</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  RUNNING</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  FINISHED</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> default</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> function</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useAnimeAsync</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  delay</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  period</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  onRun</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  onFinish</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  debug</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  delay</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  period</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  onRun</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> () </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> void</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  onFinish</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> () </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> void</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  debug</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">?:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> boolean</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">state</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> setState</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">] </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useState</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">State</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>();</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> startRef</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>(</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\">0</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> delayRef</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>(delay);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> periodRef</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(period);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> debugRef</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(debug);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> startTimerRef</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">number</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> start</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useCallback</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (state </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">===</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> undefined</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">      startTimerRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> setTimeout</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">        if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (state </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">===</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> undefined</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">          setState</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">State</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">RUNNING</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">          startRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> Date</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.now</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">();</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">          onRun</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">();</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        }</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> delayRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [onRun</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> state]);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  useEffect</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (state </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">===</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> State</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">FINISHED</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">debugRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">&#x26;&#x26;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> startRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current) {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">        console</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.log</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'--running time'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> Date</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.now</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">-</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> startRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      }</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">      onFinish</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">();</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">      setState</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">undefined</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">      clearTimeout</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">startTimerRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [state</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> onFinish]);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> stop</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useCallback</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (state </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">===</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> State</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">RUNNING</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> runTime</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> Date</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.now</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">-</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> startRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> duration</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        runTime </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">&#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> periodRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">          ?</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> periodRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">-</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> runTime</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">          :</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> periodRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">-</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (runTime </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">%</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> periodRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">debugRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current) {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">        console</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.log</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span></span>\n<span class=\"line\"><span style=\"color:#22863A;--shiki-dark:#FFAB70\">          '--duration'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">          runTime</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">          periodRef</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.current </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">%</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> runTime</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">          duration</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        );</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      }</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">      if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (duration </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">></span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 0</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">        // TODO: 完成动画周期</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">        setTimeout</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">          setState</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">State</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">FINISHED</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">        }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> duration);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">else</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">        setState</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">State</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">FINISHED</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">      }</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">else</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> if</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> (state </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">===</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> undefined</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">      setState</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">State</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">FINISHED</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [state]);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { stop</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> start };</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span></code></pre>\n<h3>🐠 使用方式</h3>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { useEffect } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'react'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> useAnimeAsync </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> './use_delay_anime'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> default</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> function</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> App</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">() {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  const</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> { </span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">start</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> stop</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> } </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> useAnimeAsync</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">({</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    delay</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 300</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // 设置等待时间 ms</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    period</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 300</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // 设置动画周期时长 ms</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    onRun</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> () </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">      // 等待时间到达时，没有触发 stop ，则触发</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">      console</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.log</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'触发动画'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    onFinish</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> () </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">      // stop 触发完成（会补充动画周期）</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">      console</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.log</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'触发结束'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    debug</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> true</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // 开启会打印时间信息</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  });</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  useEffect</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    start</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(); </span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// 启动延迟等待动画</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">    setTimeout</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(() </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">      stop</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(); </span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// 异步动作完成时停止延迟动画</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 400</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [stop]);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> &#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">div</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> className</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">=</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">\"App\"</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>&#x3C;/</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">div</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span></code></pre>",
    "fileName": "anime-async",
    "subject": [
      "snippets"
    ],
    "md5": "251af4e6f9823bb3b3f08a5713080a4f",
    "frontMatter": {
      "title": "优化异步等待动画的辅助函数",
      "description": "为异步等待动画增加最小显示时间，避免动画闪烁出现消失",
      "cover": "https://images.unsplash.com/photo-1631582053308-40f482e7ace5?q=80&w=3131&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
    }
  },
  {
    "filePath": "/Users/ben/Documents/workspace/project/z1-blog/posts/snippets/select-utils.md",
    "content": "<h3>介绍</h3>\n<p>在实际开发中，常常会遇到同一个枚举在不同场景下需要展示不同信息的情况。例如，后端定义了一组服务类型枚举，前端则可能需要为每个类型补充名称、描述或状态等额外属性。\n此时，可以通过专门的工具类，对这些复杂枚举对象进行统一的数据转换和读取，简化前端的处理逻辑，提高代码的可维护性和复用性。</p>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">/**</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> * </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">@desc</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> 多值选择类</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> */</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">import</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> _isEqual </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">from</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> 'lodash.isequal'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">export</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> default</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> class</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Select</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">T</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> extends</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Record</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">&#x3C;</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">string</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> any</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">>> {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  data</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">[];</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">  /**</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   * 定义具有多值的枚举属性类</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   * </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">@param</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> data</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   */</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">  constructor</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(data</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">[]) {</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">    this</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">.data </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> data;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">  /**</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   * 获取数组中此键名的值组成的数组</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   * </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">@param</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> key</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   */</span></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  values</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> keyof</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> result</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> this</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">data</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.map</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((item) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> item[key]);</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> result;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">  /**</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   * 根据特定的 key value 获取到数组子项</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   * </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">@param</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> key</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   * </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">@param</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> val</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">   */</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">  item</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(key</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> keyof</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> T</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> value</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">[</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">typeof</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> key]) {</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> result</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> this</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">data</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.find</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">((item</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> T</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">) </span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">=></span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> _isEqual</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(item[key]</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> value));</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">    return</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> result;</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">}</span></span></code></pre>\n<h3>🐠使用方式</h3>\n<pre class=\"shiki shiki-themes min-light min-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#1f1f1f;color:#24292eff;--shiki-dark:#b392f0\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> fruits</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\"> [</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    id</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 0</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // 数组 index 显式表达为 id</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    desc</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> '苹果'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // 前端展示的描述值</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    endValue</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 1</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\"> // 后端值</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    id</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 1</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    desc</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> '橘子'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    endValue</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 2</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  {</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    id</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 2</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    desc</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\"> '桃花'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">    endValue</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\">:</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 3</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">  }</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">];</span></span>\n<span class=\"line\"><span style=\"color:#D32F2F;--shiki-dark:#F97583\">const</span><span style=\"color:#1976D2;--shiki-dark:#79B8FF\"> fruitSelect</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> =</span><span style=\"color:#D32F2F;--shiki-dark:#F97583\"> new</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\"> Select</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(fruits);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// 获取所有的 desc ，返回数组</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">fruitSelect</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.values</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'desc'</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">); </span><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// ['苹果', '橘子', '桃花']</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// 根据特定的 kev-val 获取子项</span></span>\n<span class=\"line\"><span style=\"color:#1976D2;--shiki-dark:#79B8FF\">fruitSelect</span><span style=\"color:#6F42C1;--shiki-dark:#B392F0\">.item</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">(</span><span style=\"color:#22863A;--shiki-dark:#FFAB70\">'id'</span><span style=\"color:#212121;--shiki-dark:#BBBBBB\">,</span><span style=\"color:#1976D2;--shiki-dark:#F8F8F8\"> 1</span><span style=\"color:#24292EFF;--shiki-dark:#B392F0\">);</span></span>\n<span class=\"line\"><span style=\"color:#C2C3C5;--shiki-dark:#6B737C\">// {id:1, desc: '橘子', endValue: 2,}</span></span></code></pre>",
    "fileName": "select-utils",
    "subject": [
      "snippets"
    ],
    "md5": "9d737764a8ed8236d62c7dd81a0bc697",
    "frontMatter": {
      "title": "Select 组件工具类",
      "description": "为 Select 组件添加复合数据枚举",
      "cover": "https://images.unsplash.com/photo-1743862558369-5dcea79ccbff?q=80&w=3007&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
    }
  }
];
